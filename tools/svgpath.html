<html>

<head>
    <title>SVG Path Tester</title>
    <meta charset="utf-8" />

    <meta name="description" content="A simple tool for testing SVG path string." />
    <meta name="keywords" content="harry7557558, SVG, path, visualize" />
    <meta name="author" content="Harry Chen">
    <meta name="robots" content="index, follow" />

    <style>
        body {
            font-family: Consolas;
            font-size: 16px;
        }

        #input {
            width: 80%;
            max-width: 800px;
            min-height: 200px;
            margin: 10px;
            border: 2px solid #555;
            padding: 15px;
        }

        #transform {
            padding: 2px 5px;
            width: 60%;
            font-family: Consolas;
            font-size: 16px;
            font-style: italic;
        }

        :focus {
            outline: none;
        }

        #svgdata {
            width: max-content;
            margin: 10px;
            border: 2px solid #555;
            padding: 0;
            position: absolute;
        }

        #coord {
            position: absolute;
            top: 0;
            right: 0;
            margin: 10px 20px;
        }

        p {
            margin: 10px;
        }
    </style>
</head>

<body>
    <div id="input" title="" contenteditable="true" spellcheck="false" data-gramm="false" oninput="update_path()">
        M 180 60 C 30 -60 -70 200 180 300 C 430 200 330 -60 180 60 Z
    </div>
    <div style="margin: 10px;">
        transform = "<input id="transform" type="text" value="matrix(1,0,0,1,0,0)" oninput="update_path()" />"
    </div>
    <p>Drag to move, scroll to zoom, right click to reset.</p>
    <div id="svgdata">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="1200" height="1000">
            <g id="transfm" transform="matrix(1,0,0,1,0,0)">
                <path id="path" style="fill:white;stroke:black;" vector-effect="non-scaling-stroke" d="M 0,0" />
            </g>
        </svg>
        <span id="coord"></span>
    </div>
    <script>
        var input = document.getElementById("input"), path = document.getElementById("path"), svgcontainer = document.getElementById("svgdata"),
            transform = document.getElementById("transform"), transform_app = document.getElementById("transfm");

        function update_path() {
            input.style.borderColor = "#555";
            transform.style.color = "black";

            var txt = input.innerText;
            txt = txt.replace(/\u00A0/g, " ");
            txt = txt.replace(/\"/g, "");
            input.setAttribute("title", txt.length + " chars");
            try {
                path.setAttribute('d', txt);
            } catch (e) {  // doesn't work
                input.style.borderColor = "red";
            }

            try {
                path.setAttribute('transform', transform.value)
            } catch (e) {  // doesn't work
                transform.style.color = "red";
            }
        }

        var iSc = [1, 1];  // image scaling
        var iTr = [0, 0];  // translation from top-left
        function fromScreen(p) {
            return [
                p[0] / iSc[0] - iTr[0],
                p[1] / iSc[1] - iTr[1]
            ];
        }
        function fromCanvas(p) {
            return [
                (p[0] + iTr[0]) * iSc[0],
                (p[1] + iTr[1]) * iSc[1]
            ];
        }
        function update_transform() {
            var mat = "matrix(" + (1. * iSc[0]) + ",0,0," + (1. * iSc[1]) + "," + (iTr[0] * iSc[0]) + "," + (iTr[1] * iSc[1]) + ")";
            transform_app.setAttribute("transform", mat);
        }

        window.onload = function () {

            var drag = false;
            var mousePos = [0, 0];
            svgcontainer.onmousedown = function () {
                drag = true;
                mousePos = [e.clientX, e.clientY];
            };
            window.onmouseup = function () { drag = false; };
            window.onmousemove = function (e) {
                if (drag) {
                    iTr[0] += (e.clientX - mousePos[0]) / iSc[0];
                    iTr[1] += (e.clientY - mousePos[1]) / iSc[1];
                    update_transform();
                }
                mousePos = [e.clientX, e.clientY];
            };
            svgcontainer.onmousemove = function (e) {
                var x = e.offsetX / iSc[0] - iTr[0];
                var y = e.offsetY / iSc[1] - iTr[1];
                document.getElementById("coord").innerHTML = "(" + x.toPrecision(4) + ", " + y.toPrecision(4) + ")";
            }
            svgcontainer.onmousewheel = function (e) {
                e.preventDefault();
                var p = fromScreen([e.offsetX, e.offsetY]);
                var scf = Math.exp(0.001 * e.wheelDelta);
                var sc = [scf, scf];
                iTr[0] = (p[0] + iTr[0]) / sc[0] - p[0];
                iTr[1] = (p[1] + iTr[1]) / sc[1] - p[1];
                iSc[0] *= sc[0], iSc[1] *= sc[1];
                update_transform();
            }
            svgcontainer.oncontextmenu = function (e) {
                e.preventDefault();
                iSc = [1, 1];
                iTr = [0, 0];
                update_transform();
            }

            update_path();
        }

    </script>
</body>

</html>