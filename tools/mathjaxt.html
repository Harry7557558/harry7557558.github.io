<!doctype html>
<html>
<head>
    <title>MathJax Tester</title>
    <meta charset="utf-8" />

    <script id="mathjax-config-script" type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax:{inlineMath: [["$", "$"]], preview: "none"}, "fast-preview":{disabled: true}, AssistiveMML:{disabled: true}, menuSettings:{inTabOrder: false}, messageStyle: "simple", positionToHash: false});
        MathJax.Hub.Config({ "HTML-CSS": { styles: { ".MathJax nobr": { padding: "0.2em 0.2em" }, } } });
    </script>
    <script type="text/javascript" async="" id="MathJax_JS" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <style>
        /* disable MathJax menuframe and blue border shown when click */

        #MathJax_MenuFrame {
            opacity: 0.0;
            visibility: hidden;
            display: none;
        }

        .MathJax:focus, .mjx-chtml:focus, .MathJax_SVG:focus {
            outline-width: 0px;
            outline-style: none;
            outline-color: rgba(255,255,255,0.0);
        }

        #MathJax_Message {
            visibility: hidden;
            display: none;
        }
    </style>

    <style>
        body {
            background-color: rgb(68,68,68);
        }

        #LaTeX_Tester {
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            max-width: 1000px;
            background-color: rgb(26,35,50);
            width: 656px;
            padding: 24px 20px 30px 20px;
        }

        #TeX_Input_container {
        }

        #title {
            padding: 0px 0px 10px 10px;
            font-size: 20px;
            text-align: left;
            font-family: Consolas;
            font-style: italic;
            font-weight: 600;
            color: rgb(180,190,190);
        }

        #TeX_Input {
            height: 140px;
            width: 620px;
            border: none;
            padding: 10px;
            background-color: rgb(12,12,12);
            font-family: Consolas;
            font-size: 14px;
            font-weight: 400;
            color: white;
        }

        #TeX_PreviewBox_Frame {
            margin-left: auto;
            margin-right: auto;
            height: auto;
            min-height: 40px;
            vertical-align: central;
            width: 620px;
            padding: 16px 10px;
            background-color: rgb(220,220,225);
        }
    </style>

    <script id="Math_JS" src="https://unpkg.com/mathjs@5.7.0/dist/math.min.js"></script>
    <script>
        function $(name) {
            return document.getElementById(name);
        }
        function $$(name) {
            return document.getElementsByClassName(name);
        }
        function $$$(name) {
            return document.getElementsByTagName(name);
        }
        $("MathJax_JS").onerror = function () {
            alert("Loading MathJax Failed!");
            $("TeX_Preview").style.color = "red";
        }
        $("Math_JS").onerror = function () {
            console.error("Loading \"math.js\" failed. Math commands are not available. ");
        }
    </script>
</head>
<body onload="init();" onbeforeunload="return backup()">

    <div style="height:0px; visibility:hidden; display:none;">
        $\newcommand{\e}{\operatorname{e}}$
        $\newcommand{\csch}{\operatorname{csch}}$
        $\newcommand{\sech}{\operatorname{sech}}$
        $\newcommand{\erf}{\operatorname{erf}}$
        $\newcommand{\sgn}{\operatorname{sgn}}$
        $\newcommand{\arccot}{\operatorname{arccot}}$
        $\newcommand{\Rk}{\operatorname{R}}$
        $\newcommand{\Prj}{\operatorname{Prj}}$
        $\newcommand{\gcf}{\operatorname{gcf}}$
        $\newcommand{\lcm}{\operatorname{lcm}}$
        $\newcommand{\mod}{\operatorname{mod\>}}$
        $\newcommand{\divisible}{ {\>\large\mid\>}}$

        $\newcommand{\d} {\mathrm{d}}$
        $\newcommand{\deri}{\displaystyle\dfrac{\mathrm{d}}{\mathrm{d}x}}$
        $\newcommand{\idint}[2][x]{\displaystyle\int{#2}{\>\mathrm{d}{#1}}}$
        $\newcommand{\dint}[4][x]{\displaystyle\int_{#3}^{#4}{#2}{\>\mathrm{d}{#1}}}$
        $\newcommand{\Int}{\displaystyle\int}$
        $\newcommand{\Iint}{\displaystyle\iint}$
        $\newcommand{\Iiint}{\displaystyle\iiint}$
        $\newcommand{\Oint}{\displaystyle\oint}$
        $\newcommand{\Oiint}{\displaystyle{\LARGE\raise{-0.13em}{\unicode{0x2b2d}}\kern-1.56em}\iint}$
        $\newcommand{\oiint}{ {\LARGE\unicode{0x222F}}}$

        $\newcommand{\pmat}[1]{\begin{pmatrix}#1\end{pmatrix}}$
        $\newcommand{\bmat}[1]{\begin{bmatrix}#1\end{bmatrix}}$
        $\newcommand{\vmat}[1]{\begin{vmatrix}#1\end{vmatrix}}$
        $\newcommand{\equd}[2]{\displaystyle\left\{ {\begin{array}{l} {#1} \\ {#2} \end{array}}\right.}$
        $\newcommand{\Sum}[3]{\displaystyle\sum\limits_{#2}\limits^{#3}{#1}}$

        $\newcommand{\Alpha}{\unicode{0x0391}}$
        $\newcommand{\Beta}{\unicode{0x0392}}$
        $\newcommand{\Epsilon}{\unicode{0x0395}}$
        $\newcommand{\Zeta}{\unicode{0x0396}}$
        $\newcommand{\Eta}{\unicode{0x0397}}$
        $\newcommand{\Iota}{\unicode{0x0399}}$
        $\newcommand{\Kappa}{\unicode{0x039A}}$
        $\newcommand{\Mu}{\unicode{0x039C}}$
        $\newcommand{\Nu}{\unicode{0x039D}}$
        $\newcommand{\Omicron}{\unicode{0x039F}}$
        $\newcommand{\Tau}{\unicode{0x03A4}}$
        $\newcommand{\Chi}{\unicode{0x03A7}}$

        $\newcommand{\N}{\unicode{0x2115}}$
        $\newcommand{\Z}{\unicode{0x2124}}$
        $\newcommand{\P}{\unicode{0x2119}}$
        $\newcommand{\Q}{\unicode{0x211A}}$
        $\newcommand{\R}{\unicode{0x211D}}$
        $\newcommand{\C}{\unicode{0x2102}}$
        $\newcommand{\H}{\unicode{0x210D}}$


    </div>

    <div id="LaTeX_Tester">
        <div id="TeX_Input_container">
            <div id="title">type LaTeX there: </div>
            <textarea id="TeX_Input" type="text" spellcheck="false"
                      oninput="Render()">\displaystyle f(a) = \dfrac{1}{2\pi i} \oint_\gamma \frac{f(z)}{z-a}\d{z}</textarea>
        </div>
        <div id="TeX_PreviewBox_Frame">
            <div id="TeX_PreviewBox">
                <div id="TeX_Preview"></div>
            </div>
        </div>
        <script>
            function getCursortPos(obj) {
                var cursorIndex = 0;
                if (document.selection) {
                    obj.focus();
                    var range = document.selection.createRange();
                    range.moveStart('character', -obj.value.length);
                    cursorIndex = range.text.length;
                } else if (obj.selectionStart || obj.selectionStart == 0) {
                    cursorIndex = obj.selectionStart;
                }
                return cursorIndex;
            }
            function moveCursortTo(obj, pos) {
                obj.setSelectionRange(pos, pos);
            }
            function insert(str, dir, part) {
                return str.substr(0, dir) + part + str.substring(dir, str.length);
            }
            function erase(str, dir, num) {
                return str.substr(0, dir) + str.substring(dir + num, str.length);
            }
        </script>
        <script>
            function toLaTeX(s) {
                s = s.replace(/\*/g, "{\\cdot}");
                var fun = ['sin', 'cos', 'tan', 'csc', 'sec', 'cot', 'exp', 'log', 'ln', 'sinh', 'cosh', 'tanh'];
                for (var i = 0; i < fun.length; i++) {
                    var n = 0;
                    while (s.match(fun[i])) s = s.splice(s.search(fun[i], 0), fun[i].length, fun[i].toLocaleUpperCase());
                    while (s.match(fun[i].toLocaleUpperCase())) s = s.splice(s.search(fun[i].toLocaleUpperCase(), 0), fun[i].length, '{\\' + fun[i] + '}');
                }
                s = s.replace(/\n\n/g, '\\\\[6pt]');
                s = s.replace(/\n/g, '\\\\{\\qquad}');
                return s;
            }
        </script>
        <script>
            var tex = $("TeX_Input");
            var pref = $("TeX_PreviewBox_Frame");
            var pre = $("TeX_PreviewBox");
            var fom = $("TeX_Preview");
            var prevpos = 0, maxheight = 0;
            var histht = 0;

            var cookie_enabled = navigator.cookieEnabled;  // In most browsers, local HTML files are not allowed to set cookies
            function init() {
                String.prototype.splice = function(start, delCount, newSubStr) {
                    return this.slice(0, start) + newSubStr + this.slice(start + Math.abs(delCount));
                };
                tex.value = "% Example Formula \n\\displaystyle f(a) = \\dfrac{1}{2\\pi i} \\oint_\\gamma \\frac{f(z)}{z-a} \\d{z} \n";
                if (cookie_enabled) {
                    var getCookie = function getCookie(cname) {
                        var name = cname + "=";
                        var ca = document.cookie.split(';');
                        for (var i = 0; i < ca.length; i++) {
                            var c = ca[i].trim();
                            if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
                        }
                        return "";
                    };
                    var s = getCookie("FinInput");
                    if (s != "") tex.value = s;
                    console.log(s);
                }
                fom.innerHTML = "$" + tex.value.replace(/</g, "&lt;") + "$";
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                setTimeout(function() {
                    histht = fom.getBoundingClientRect().height;
                    fom.style.minHeight = histht + "px";
                }, 1000)
            }

            function backup() {
                if (!cookie_enabled) return 0;
                document.cookie = "FinInput=" + tex.value + "; expires=Thu, 18 Dec 2043 12:00:00 GMT";
                if (document.cookie == "") return 0;
                return 1;
            }

            function Render() {
                var ht = fom.getBoundingClientRect().height;
                if (ht > histht) {
                    histht = ht;
                    fom.style.minHeight = histht + "px";
                }

                var pos = getCursortPos(tex);
                if (pos > prevpos) {
                    if (tex.value.charAt(pos - 1) == "{") {
                        tex.value = insert(tex.value, pos, "}");
                        moveCursortTo(tex, pos);
                    }
                    else if (tex.value.charAt(pos - 1) == "}" && tex.value.charAt(pos) == "}") {
                        tex.value = erase(tex.value, pos, 1);
                        moveCursortTo(tex, pos);
                    }
                }
                if (tex.value != "") {
                    if (/\\/.test(tex.value)) fom.innerHTML = "$" + tex.value.replace(/</g, "&lt;") + "$";
                    else fom.innerHTML = "$" + toLaTeX(tex.value).replace(/</g, "&lt;") + "$";
                    backup();
                }
                else fom.innerText = "";
                prevpos = pos;

                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);    // refresh MathJax
            }
        </script>
    </div>
</body>
</html>